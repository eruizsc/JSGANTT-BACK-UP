var JSGantt;JSGantt||(JSGantt={});var vTimeout=0,vBenchTime=(new Date).getTime(),vSelectedLang;JSGantt.isIE=function(){return void 0!==document.all},JSGantt.TaskItem=function(pID,pName,pStart,pEnd,pColor,pLink,pMile,pRes,pComp,pGroup,pParent,pOpen,pDepend,pCaption,pActionLink){var vID=pID,vName=pName,vStart=new Date,vEnd=new Date,vColor=pColor,vLink=pLink,vLinkIsAction=pActionLink,vMile=pMile,vRes=pRes,vComp=pComp,vGroup=pGroup,vParent=pParent,vOpen=pOpen,vDepend=pDepend,vCaption=pCaption,vDuration="",vLevel=0,vNumKid=0,vVisible=1,x1,y1,x2,y2;1!=vGroup&&(vStart=JSGantt.parseDateStr(pStart,g.getDateInputFormat()),vEnd=JSGantt.parseDateStr(pEnd,g.getDateInputFormat())),this.getID=function(){return vID},this.getName=function(){return vName},this.getStart=function(){return vStart},this.getEnd=function(){return vEnd},this.getColor=function(){return vColor},this.getLink=function(){return vLink},this.getLinkIsAction=function(){return vLinkIsAction},this.getMile=function(){return vMile},this.getDepend=function(){return vDepend||null},this.getCaption=function(){return vCaption||""},this.getResource=function(){return vRes||"&nbsp"},this.getCompVal=function(){return vComp||0},this.getCompStr=function(){return vComp?vComp+"%":""},this.getDuration=function(vFormat){return vMile?vDuration="-":"hour"==vFormat?(tmpPer=Math.ceil((this.getEnd()-this.getStart())/36e5),vDuration=1==tmpPer?"1 "+vSelectedLang.time.hour:tmpPer+ +vSelectedLang.time.hours):"minute"==vFormat?(tmpPer=Math.ceil((this.getEnd()-this.getStart())/6e4),vDuration=1==tmpPer?"1 "+vSelectedLang.time.minute:tmpPer+vSelectedLang.time.minutes):(tmpPer=Math.ceil((this.getEnd()-this.getStart())/864e5+1),vDuration=1==tmpPer?"1 "+vSelectedLang.time.day:tmpPer+vSelectedLang.time.days),vDuration},this.getParent=function(){return vParent},this.getGroup=function(){return vGroup},this.getOpen=function(){return vOpen},this.getLevel=function(){return vLevel},this.getNumKids=function(){return vNumKid},this.getStartX=function(){return x1},this.getStartY=function(){return y1},this.getEndX=function(){return x2},this.getEndY=function(){return y2},this.getVisible=function(){return vVisible},this.setDepend=function(pDepend){vDepend=pDepend},this.setStart=function(pStart){vStart=pStart},this.setEnd=function(pEnd){vEnd=pEnd},this.setLevel=function(pLevel){vLevel=pLevel},this.setNumKid=function(pNumKid){vNumKid=pNumKid},this.setCompVal=function(pCompVal){vComp=pCompVal},this.setStartX=function(pX){x1=pX},this.setStartY=function(pY){y1=pY},this.setEndX=function(pX){x2=pX},this.setEndY=function(pY){y2=pY},this.setOpen=function(pOpen){vOpen=pOpen},this.setVisible=function(pVisible){vVisible=pVisible}},JSGantt.GanttChart=function(pGanttVar,pDiv,pFormat,pLang){vSelectedLang=pLang&&""!=pLang?vLang[pLang]:vLang.en;var vGanttVar=pGanttVar,vDiv=pDiv,vFormat=pFormat,vShowRes=1,vShowDur=1,vShowComp=1,vShowLastRow=1,vShowStartDate=1,vShowEndDate=1,vDateInputFormat="mm/dd/yyyy",vDateDisplayFormat="mm/dd/yy",vNumUnits=0,vCaptionType,vDepId=1,vTaskList=new Array,vFormatArr=new Array("day","week","month","quarter"),vQuarterArr=new Array(1,1,1,2,2,2,3,3,3,4,4,4),vMonthDaysArr=new Array(31,28,31,30,31,30,31,31,30,31,30,31),vMonthArr=vSelectedLang.months;this.setFormatArr=function(){vFormatArr=new Array;for(var i=0;i<arguments.length;i++)vFormatArr[i]=arguments[i];vFormatArr.length>4&&(vFormatArr.length=4)},this.setShowRes=function(pShow){vShowRes=pShow},this.setShowDur=function(pShow){vShowDur=pShow},this.setShowComp=function(pShow){vShowComp=pShow},this.setShowStartDate=function(pShow){vShowStartDate=pShow},this.setShowEndDate=function(pShow){vShowEndDate=pShow},this.setDateInputFormat=function(pShow){vDateInputFormat=pShow},this.setDateDisplayFormat=function(pShow){vDateDisplayFormat=pShow},this.setShowLastRow=function(pShow){vShowLastRow=pShow},this.setCaptionType=function(pType){vCaptionType=pType},this.setFormat=function(pFormat){vFormat=pFormat,this.Draw()},this.getShowRes=function(){return vShowRes},this.getShowDur=function(){return vShowDur},this.getShowComp=function(){return vShowComp},this.getShowStartDate=function(){return vShowStartDate},this.getShowEndDate=function(){return vShowEndDate},this.getDateInputFormat=function(){return vDateInputFormat},this.getDateDisplayFormat=function(){return vDateDisplayFormat},this.getCaptionType=function(){return vCaptionType},this.CalcTaskXY=function(){var vList=this.getList(),vTaskDiv,vParDiv,vLeft,vTop,vHeight,vWidth;for(i=0;i<vList.length;i++)vID=vList[i].getID(),vTaskDiv=document.getElementById("taskbar_"+vID),vBarDiv=document.getElementById("bardiv_"+vID),vParDiv=document.getElementById("childgrid_"+vID),vBarDiv&&(vList[i].setStartX(vBarDiv.offsetLeft),vList[i].setStartY(vParDiv.offsetTop+vBarDiv.offsetTop+6),vList[i].setEndX(vBarDiv.offsetLeft+vBarDiv.offsetWidth),vList[i].setEndY(vParDiv.offsetTop+vBarDiv.offsetTop+6))},this.AddTaskItem=function(value){vTaskList.push(value)},this.getList=function(){return vTaskList},this.clearDependencies=function(){var parent=document.getElementById("rightside"),depLine,vMaxId=vDepId;for(i=1;i<vMaxId;i++)(depLine=document.getElementById("line"+i))&&parent.removeChild(depLine);vDepId=1},this.sLine=function(x1,y1,x2,y2){vLeft=Math.min(x1,x2),vTop=Math.min(y1,y2),vWid=Math.abs(x2-x1)+1,vHgt=Math.abs(y2-y1)+1,vDoc=document.getElementById("rightside");var oDiv=document.createElement("div");oDiv.id="line"+vDepId++,oDiv.style.position="absolute",oDiv.style.margin="0px",oDiv.style.padding="0px",oDiv.style.overflow="hidden",oDiv.style.border="0px",oDiv.style.zIndex=0,oDiv.style.backgroundColor="red",oDiv.style.left=vLeft+"px",oDiv.style.top=vTop+"px",oDiv.style.width=vWid+"px",oDiv.style.height=vHgt+"px",oDiv.style.visibility="visible",vDoc.appendChild(oDiv)},this.dLine=function(x1,y1,x2,y2){var dx=x2-x1,dy=y2-y1,x=x1,y=y1,n=Math.max(Math.abs(dx),Math.abs(dy));for(dx/=n,dy/=n,i=0;i<=n;i++)vx=Math.round(x),vy=Math.round(y),this.sLine(vx,vy,vx,vy),x+=dx,y+=dy},this.drawDependency=function(x1,y1,x2,y2){x1+10<x2?(this.sLine(x1,y1,x1+4,y1),this.sLine(x1+4,y1,x1+4,y2),this.sLine(x1+4,y2,x2,y2),this.dLine(x2,y2,x2-3,y2-3),this.dLine(x2,y2,x2-3,y2+3),this.dLine(x2-1,y2,x2-3,y2-2),this.dLine(x2-1,y2,x2-3,y2+2)):(this.sLine(x1,y1,x1+4,y1),this.sLine(x1+4,y1,x1+4,y2-10),this.sLine(x1+4,y2-10,x2-8,y2-10),this.sLine(x2-8,y2-10,x2-8,y2),this.sLine(x2-8,y2,x2,y2),this.dLine(x2,y2,x2-3,y2-3),this.dLine(x2,y2,x2-3,y2+3),this.dLine(x2-1,y2,x2-3,y2-2),this.dLine(x2-1,y2,x2-3,y2+2))},this.DrawDependencies=function(){this.CalcTaskXY(),this.clearDependencies();for(var vList=this.getList(),i=0;i<vList.length;i++)if(vDepend=vList[i].getDepend(),vDepend)for(var vDependStr,vDepList=(vDepend+"").split(","),n=vDepList.length,k=0;k<n;k++){var vTask=this.getArrayLocationByID(vDepList[k]);1==vList[vTask].getVisible()&&this.drawDependency(vList[vTask].getEndX(),vList[vTask].getEndY(),vList[i].getStartX()-1,vList[i].getStartY())}},this.getArrayLocationByID=function(pId){for(var vList=this.getList(),i=0;i<vList.length;i++)if(vList[i].getID()==pId)return i},this.Draw=function(){var vMaxDate=new Date,vMinDate=new Date,vTmpDate=new Date,vNxtDate=new Date,vCurrDate=new Date,vTaskLeft=0,vTaskRight=0,vNumCols=0,vID=0,vMainTable="",vLeftTable="",vRightTable="",vDateRowStr="",vItemRowStr="",vColWidth=0,vColUnit=0,vChartWidth=0,vNumDays=0,vDayWidth=0,vStr="",vNameWidth=100,vStatusWidth=70,vLeftWidth=585;if(vTaskList.length>0){for(JSGantt.processRows(vTaskList,0,-1,1,1),vMinDate=JSGantt.getMinDate(vTaskList,vFormat),vMaxDate=JSGantt.getMaxDate(vTaskList,vFormat),"day"==vFormat?(vColWidth=18,vColUnit=1):"week"==vFormat?(vColWidth=37,vColUnit=7):"month"==vFormat?(vColWidth=37,vColUnit=30):"quarter"==vFormat?(vColWidth=60,vColUnit=90):"hour"==vFormat?(vColWidth=18,vColUnit=1):"minute"==vFormat&&(vColWidth=18,vColUnit=1),vNumDays=(Date.parse(vMaxDate)-Date.parse(vMinDate))/864e5,vChartWidth=(vNumUnits=vNumDays/vColUnit)*vColWidth+1,vDayWidth=vColWidth/vColUnit+1/vColUnit,vMainTable="<TABLE id=theTable cellSpacing=0 cellPadding=0 border=0><TBODY><TR><TD vAlign=top bgColor=#ffffff>",1!=vShowRes&&(vNameWidth+=70),1!=vShowDur&&(vNameWidth+=70),1!=vShowComp&&(vNameWidth+=70),1!=vShowStartDate&&(vNameWidth+=70),1!=vShowEndDate&&(vNameWidth+=70),vLeftTable='<DIV class=scroll id=leftside style="width:100%"><TABLE cellSpacing=0 cellPadding=0 border=0><TBODY><TR style="HEIGHT: 17px">  <TD style="WIDTH: 15px; HEIGHT: 17px"></TD>  <TD style="WIDTH: '+vNameWidth+'px; HEIGHT: 17px"><NOBR></NOBR></TD>',1==vShowRes&&(vLeftTable+='  <TD style="WIDTH: 70px; HEIGHT: 17px"></TD>'),1==vShowDur&&(vLeftTable+='  <TD style="WIDTH: 70px; HEIGHT: 17px"></TD>'),1==vShowComp&&(vLeftTable+='  <TD style="WIDTH: 70px; HEIGHT: 17px"></TD>'),1==vShowStartDate&&(vLeftTable+='  <TD style="WIDTH: 70px; HEIGHT: 17px"></TD>'),1==vShowEndDate&&(vLeftTable+='  <TD style="WIDTH: 70px; HEIGHT: 17px"></TD>'),vLeftTable+='<TR style="HEIGHT: 20px">  <TD style="BORDER-TOP: #efefef 1px solid; WIDTH: 15px; HEIGHT: 20px"></TD>  <TD style="BORDER-TOP: #efefef 1px solid; WIDTH: '+vNameWidth+'px; HEIGHT: 20px"><NOBR></NOBR></TD>',1==vShowRes&&(vLeftTable+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>'+vSelectedLang.tableHead.resource+"</TD>"),1==vShowDur&&(vLeftTable+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>'+vSelectedLang.tableHead.duration+"</TD>"),1==vShowComp&&(vLeftTable+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 60px; HEIGHT: 20px" align=center nowrap>'+vSelectedLang.tableHead.comp+"</TD>"),1==vShowStartDate&&(vLeftTable+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 75px; HEIGHT: 20px" align=center nowrap>'+vSelectedLang.tableHead.sDate+"</TD>"),1==vShowEndDate&&(vLeftTable+='  <TD style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; WIDTH: 75px; HEIGHT: 20px" align=center nowrap>'+vSelectedLang.tableHead.eDate+"</TD>"),vLeftTable+="</TR>",i=0;i<vTaskList.length;i++){for(vTaskList[i].getGroup()?(vBGColor="f3f3f3",vRowType="group"):(vBGColor="ffffff",vRowType="row"),vID=vTaskList[i].getID(),0==vTaskList[i].getVisible()?vLeftTable+="<TR id=child_"+vID+" bgcolor=#"+vBGColor+' style="display:none"  onMouseover=g.mouseOver(this,'+vID+',"left","'+vRowType+'") onMouseout=g.mouseOut(this,'+vID+',"left","'+vRowType+'")>':vLeftTable+="<TR id=child_"+vID+" bgcolor=#"+vBGColor+" onMouseover=g.mouseOver(this,"+vID+',"left","'+vRowType+'") onMouseout=g.mouseOut(this,'+vID+',"left","'+vRowType+'")>',vLeftTable+='  <TD class=gdatehead style="WIDTH: 15px; HEIGHT: 20px; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;">&nbsp;</TD>  <TD class=gname style="WIDTH: '+vNameWidth+'px; HEIGHT: 20px; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px;" nowrap><NOBR><span style="color: #aaaaaa">',j=1;j<vTaskList[i].getLevel();j++)vLeftTable+="&nbsp&nbsp&nbsp&nbsp";vLeftTable+="</span>",vTaskList[i].getGroup()?1==vTaskList[i].getOpen()?vLeftTable+='<SPAN id="group_'+vID+'" style="color:#000000; cursor:pointer; font-weight:bold; FONT-SIZE: 12px;" onclick="JSGantt.folder('+vID+","+vGanttVar+");"+vGanttVar+'.DrawDependencies();">&ndash;</span><span style="color:#000000">&nbsp</SPAN>':vLeftTable+='<SPAN id="group_'+vID+'" style="color:#000000; cursor:pointer; font-weight:bold; FONT-SIZE: 12px;" onclick="JSGantt.folder('+vID+","+vGanttVar+");"+vGanttVar+'.DrawDependencies();">+</span><span style="color:#000000">&nbsp</SPAN>':vLeftTable+='<span style="color: #000000; font-weight:bold; FONT-SIZE: 12px;">&nbsp&nbsp&nbsp</span>',vLeftTable+=1==vTaskList[i].getLinkIsAction()?'<span onclick="'+vTaskList[i].getLink()+';" style="cursor:pointer"> '+vTaskList[i].getName()+"</span></NOBR></TD>":'<span onclick=JSGantt.taskLink("'+vTaskList[i].getLink()+'",300,200); style="cursor:pointer"> '+vTaskList[i].getName()+"</span></NOBR></TD>",1==vShowRes&&(vLeftTable+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+vTaskList[i].getResource()+"</NOBR></TD>"),1==vShowDur&&(vLeftTable+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+vTaskList[i].getDuration(vFormat)+"</NOBR></TD>"),1==vShowComp&&(vLeftTable+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+vTaskList[i].getCompStr()+"</NOBR></TD>"),1==vShowStartDate&&(vLeftTable+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+JSGantt.formatDateStr(vTaskList[i].getStart(),vDateDisplayFormat)+"</NOBR></TD>"),1==vShowEndDate&&(vLeftTable+='  <TD class=gname style="WIDTH: 60px; HEIGHT: 20px; TEXT-ALIGN: center; BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><NOBR>'+JSGantt.formatDateStr(vTaskList[i].getEnd(),vDateDisplayFormat)+"</NOBR></TD>"),vLeftTable+="</TR>"}for(1==vShowLastRow&&(vLeftTable+='</TD></TR><TR><TD border=1 colspan=5 align=left style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 11px; BORDER-LEFT: #efefef 1px solid; height=18px">&nbsp;&nbsp;Powered by <a href=http://www.jsgantt.com>jsGantt</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Format:',-1!=vFormatArr.join().indexOf("minute")&&(vLeftTable+="minute"==vFormat?'<INPUT TYPE=RADIO NAME="radFormat" VALUE="minute" checked>Minute':'<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("minute",'+vGanttVar+'); VALUE="minute">Minute'),-1!=vFormatArr.join().indexOf("hour")&&(vLeftTable+="hour"==vFormat?'<INPUT TYPE=RADIO NAME="radFormat" VALUE="hour" checked>Hour':'<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("hour",'+vGanttVar+'); VALUE="hour">Hour'),-1!=vFormatArr.join().indexOf("day")&&(vLeftTable+="day"==vFormat?'<INPUT TYPE=RADIO NAME="radFormat" VALUE="day" checked>Day':'<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("day",'+vGanttVar+'); VALUE="day">Day'),-1!=vFormatArr.join().indexOf("week")&&(vLeftTable+="week"==vFormat?'<INPUT TYPE=RADIO NAME="radFormat" VALUE="week" checked>Week':'<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("week",'+vGanttVar+') VALUE="week">Week'),-1!=vFormatArr.join().indexOf("month")&&(vLeftTable+="month"==vFormat?'<INPUT TYPE=RADIO NAME="radFormat" VALUE="month" checked>Month':'<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("month",'+vGanttVar+') VALUE="month">Month'),-1!=vFormatArr.join().indexOf("quarter")&&(vLeftTable+="quarter"==vFormat?'<INPUT TYPE=RADIO NAME="radFormat" VALUE="quarter" checked>Quarter':'<INPUT TYPE=RADIO NAME="radFormat" onclick=JSGantt.changeFormat("quarter",'+vGanttVar+') VALUE="quarter">Quarter'),vLeftTable+="</TD></TR>"),vMainTable+=vLeftTable+="</TBODY></TABLE></TD>",vRightTable='<TD style="width: '+vChartWidth+'px;" vAlign=top bgColor=#ffffff><DIV class=scroll2 id=rightside><TABLE style="width: '+vChartWidth+'px;" cellSpacing=0 cellPadding=0 border=0><TBODY><TR style="HEIGHT: 18px">',vTmpDate.setFullYear(vMinDate.getFullYear(),vMinDate.getMonth(),vMinDate.getDate()),vTmpDate.setHours(0),vTmpDate.setMinutes(0);Date.parse(vTmpDate)<=Date.parse(vMaxDate);)if(vStr=(vStr=vTmpDate.getFullYear()+"").substring(2,4),"minute"==vFormat&&(vRightTable+='<td class=gdatehead style="FONT-SIZE: 12px; HEIGHT: 19px;" align=center colspan=60>',vRightTable+=JSGantt.formatDateStr(vTmpDate,vDateDisplayFormat)+" "+vTmpDate.getHours()+":00 -"+vTmpDate.getHours()+":59 </td>",vTmpDate.setHours(vTmpDate.getHours()+1)),"hour"==vFormat&&(vRightTable+='<td class=gdatehead style="FONT-SIZE: 12px; HEIGHT: 19px;" align=center colspan=24>',vRightTable+=JSGantt.formatDateStr(vTmpDate,vDateDisplayFormat)+"</td>",vTmpDate.setDate(vTmpDate.getDate()+1)),"day"==vFormat)vRightTable+='<td class=gdatehead style="FONT-SIZE: 12px; HEIGHT: 19px;" align=center colspan=7>'+JSGantt.formatDateStr(vTmpDate,vDateDisplayFormat.substring(0,5))+" - ",vTmpDate.setDate(vTmpDate.getDate()+6),vRightTable+=JSGantt.formatDateStr(vTmpDate,vDateDisplayFormat)+"</td>",vTmpDate.setDate(vTmpDate.getDate()+1);else if("week"==vFormat)vRightTable+='<td class=gdatehead align=center style="FONT-SIZE: 12px; HEIGHT: 19px;" width='+vColWidth+"px>`"+vStr+"</td>",vTmpDate.setDate(vTmpDate.getDate()+7);else if("month"==vFormat)for(vRightTable+='<td class=gdatehead align=center style="FONT-SIZE: 12px; HEIGHT: 19px;" width='+vColWidth+"px>`"+vStr+"</td>",vTmpDate.setDate(vTmpDate.getDate()+1);vTmpDate.getDate()>1;)vTmpDate.setDate(vTmpDate.getDate()+1);else if("quarter"==vFormat)for(vRightTable+='<td class=gdatehead align=center style="FONT-SIZE: 12px; HEIGHT: 19px;" width='+vColWidth+"px>`"+vStr+"</td>",vTmpDate.setDate(vTmpDate.getDate()+81);vTmpDate.getDate()>1;)vTmpDate.setDate(vTmpDate.getDate()+1);for(vRightTable+="</TR><TR>",vTmpDate.setFullYear(vMinDate.getFullYear(),vMinDate.getMonth(),vMinDate.getDate()),vNxtDate.setFullYear(vMinDate.getFullYear(),vMinDate.getMonth(),vMinDate.getDate()),vNumCols=0;Date.parse(vTmpDate)<=Date.parse(vMaxDate);)if("minute"==vFormat)0==vTmpDate.getMinutes()?vWeekdayColor="ccccff":vWeekdayColor="ffffff",vDateRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">'+vTmpDate.getMinutes()+"</div></td>",vItemRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>',vTmpDate.setMinutes(vTmpDate.getMinutes()+1);else if("hour"==vFormat)0==vTmpDate.getHours()?vWeekdayColor="ccccff":vWeekdayColor="ffffff",vDateRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">'+vTmpDate.getHours()+"</div></td>",vItemRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>',vTmpDate.setHours(vTmpDate.getHours()+1);else if("day"==vFormat)JSGantt.formatDateStr(vCurrDate,"mm/dd/yyyy")==JSGantt.formatDateStr(vTmpDate,"mm/dd/yyyy")?(vWeekdayColor="ccccff",vWeekendColor="9999ff",vWeekdayGColor="bbbbff",vWeekendGColor="8888ff"):(vWeekdayColor="ffffff",vWeekendColor="cfcfcf",vWeekdayGColor="f3f3f3",vWeekendGColor="c3c3c3"),vTmpDate.getDay()%6==0?(vDateRowStr+='<td class="gheadwkend" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekendColor+' align=center><div style="width: '+vColWidth+'px">'+vTmpDate.getDate()+"</div></td>",vItemRowStr+='<td class="gheadwkend" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekendColor+' align=center><div style="width: '+vColWidth+'px">&nbsp</div></td>'):(vDateRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">'+vTmpDate.getDate()+"</div></td>",JSGantt.formatDateStr(vCurrDate,"mm/dd/yyyy")==JSGantt.formatDateStr(vTmpDate,"mm/dd/yyyy")?vItemRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>':vItemRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; cursor: default;"  align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>'),vTmpDate.setDate(vTmpDate.getDate()+1);else if("week"==vFormat)vNxtDate.setDate(vNxtDate.getDate()+7),vWeekdayColor=vCurrDate>=vTmpDate&&vCurrDate<vNxtDate?"ccccff":"ffffff",vNxtDate<=vMaxDate?(vDateRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+vColWidth+'px><div style="width: '+vColWidth+'px">'+(vTmpDate.getMonth()+1)+"/"+vTmpDate.getDate()+"</div></td>",vItemRowStr+=vCurrDate>=vTmpDate&&vCurrDate<vNxtDate?'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>':'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>'):(vDateRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid; bgcolor=#'+vWeekdayColor+' BORDER-RIGHT: #efefef 1px solid;" align=center width:'+vColWidth+'px><div style="width: '+vColWidth+'px">'+(vTmpDate.getMonth()+1)+"/"+vTmpDate.getDate()+"</div></td>",vItemRowStr+=vCurrDate>=vTmpDate&&vCurrDate<vNxtDate?'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>':'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>'),vTmpDate.setDate(vTmpDate.getDate()+7);else if("month"==vFormat)for(vNxtDate.setFullYear(vTmpDate.getFullYear(),vTmpDate.getMonth(),vMonthDaysArr[vTmpDate.getMonth()]),vWeekdayColor=vCurrDate>=vTmpDate&&vCurrDate<vNxtDate?"ccccff":"ffffff",vNxtDate<=vMaxDate?(vDateRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+vColWidth+'px><div style="width: '+vColWidth+'px">'+vMonthArr[vTmpDate.getMonth()].substr(0,3)+"</div></td>",vItemRowStr+=vCurrDate>=vTmpDate&&vCurrDate<vNxtDate?'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>':'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>'):(vDateRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+vColWidth+'px><div style="width: '+vColWidth+'px">'+vMonthArr[vTmpDate.getMonth()].substr(0,3)+"</div></td>",vItemRowStr+=vCurrDate>=vTmpDate&&vCurrDate<vNxtDate?'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>':'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>'),vTmpDate.setDate(vTmpDate.getDate()+1);vTmpDate.getDate()>1;)vTmpDate.setDate(vTmpDate.getDate()+1);else if("quarter"==vFormat)for(vNxtDate.setDate(vNxtDate.getDate()+122),0==vTmpDate.getMonth()||1==vTmpDate.getMonth()||2==vTmpDate.getMonth()?vNxtDate.setFullYear(vTmpDate.getFullYear(),2,31):3==vTmpDate.getMonth()||4==vTmpDate.getMonth()||5==vTmpDate.getMonth()?vNxtDate.setFullYear(vTmpDate.getFullYear(),5,30):6==vTmpDate.getMonth()||7==vTmpDate.getMonth()||8==vTmpDate.getMonth()?vNxtDate.setFullYear(vTmpDate.getFullYear(),8,30):9!=vTmpDate.getMonth()&&10!=vTmpDate.getMonth()&&11!=vTmpDate.getMonth()||vNxtDate.setFullYear(vTmpDate.getFullYear(),11,31),vWeekdayColor=vCurrDate>=vTmpDate&&vCurrDate<vNxtDate?"ccccff":"ffffff",vNxtDate<=vMaxDate?(vDateRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+vColWidth+'px><div style="width: '+vColWidth+'px">Qtr. '+vQuarterArr[vTmpDate.getMonth()]+"</div></td>",vItemRowStr+=vCurrDate>=vTmpDate&&vCurrDate<vNxtDate?'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>':'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid;" align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>'):(vDateRowStr+='<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; HEIGHT: 19px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+" align=center width:"+vColWidth+'px><div style="width: '+vColWidth+'px">Qtr. '+vQuarterArr[vTmpDate.getMonth()]+"</div></td>",vItemRowStr+=vCurrDate>=vTmpDate&&vCurrDate<vNxtDate?'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" bgcolor=#'+vWeekdayColor+' align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>':'<td class="ghead" style="BORDER-TOP: #efefef 1px solid; FONT-SIZE: 12px; BORDER-LEFT: #efefef 1px solid; BORDER-RIGHT: #efefef 1px solid;" align=center><div style="width: '+vColWidth+'px">&nbsp&nbsp</div></td>'),vTmpDate.setDate(vTmpDate.getDate()+81);vTmpDate.getDate()>1;)vTmpDate.setDate(vTmpDate.getDate()+1);for(vRightTable+=vDateRowStr+"</TR>",vRightTable+="</TBODY></TABLE>",i=0;i<vTaskList.length;i++){if(vTmpDate.setFullYear(vMinDate.getFullYear(),vMinDate.getMonth(),vMinDate.getDate()),vTaskStart=vTaskList[i].getStart(),vTaskEnd=vTaskList[i].getEnd(),vNumCols=0,vID=vTaskList[i].getID(),vNumUnits=(vTaskList[i].getEnd()-vTaskList[i].getStart())/864e5+1,"hour"==vFormat?vNumUnits=(vTaskList[i].getEnd()-vTaskList[i].getStart())/6e4+1:"minute"==vFormat&&(vNumUnits=(vTaskList[i].getEnd()-vTaskList[i].getStart())/6e4+1),0==vTaskList[i].getVisible()?vRightTable+="<DIV id=childgrid_"+vID+' style="position:relative; display:none;">':vRightTable+="<DIV id=childgrid_"+vID+' style="position:relative">',vTaskList[i].getMile()){if(vRightTable+='<DIV><TABLE style="position:relative; top:0px; width: '+vChartWidth+'px;" cellSpacing=0 cellPadding=0 border=0><TR id=childrow_'+vID+' class=yesdisplay style="HEIGHT: 20px" onMouseover=g.mouseOver(this,'+vID+',"right","mile") onMouseout=g.mouseOut(this,'+vID+',"right","mile")>'+vItemRowStr+"</TR></TABLE></DIV>",vDateRowStr=JSGantt.formatDateStr(vTaskStart,vDateDisplayFormat),vTaskLeft=(Date.parse(vTaskList[i].getStart())-Date.parse(vMinDate))/864e5,vTaskRight=1,vRightTable+="<div id=bardiv_"+vID+' style="position:absolute; top:0px; left:'+(Math.ceil(vTaskLeft*vDayWidth+1)+6)+'px; height: 18px; width:160px; overflow:hidden;">'+(1==vTaskList[i].getLinkIsAction()?"  <div id=taskbar_"+vID+' title="'+vTaskList[i].getName()+": "+vDateRowStr+'" class="taskBar" onclick="'+vTaskList[i].getLink()+';">':"  <div id=taskbar_"+vID+' title="'+vTaskList[i].getName()+": "+vDateRowStr+'" class="taskBar" onclick=JSGantt.taskLink("'+vTaskList[i].getLink()+'",300,200);>'),vTaskList[i].getCompVal()<100?vRightTable+="&loz;</div>":vRightTable+="&diams;</div>",g.getCaptionType()){switch(vCaptionStr="",g.getCaptionType()){case"Caption":vCaptionStr=vTaskList[i].getCaption();break;case"Resource":vCaptionStr=vTaskList[i].getResource();break;case"Duration":vCaptionStr=vTaskList[i].getDuration(vFormat);break;case"Complete":vCaptionStr=vTaskList[i].getCompStr()}vRightTable+='<div style="FONT-SIZE:12px; position:absolute; top:2px; width:120px; left:12px">'+vCaptionStr+"</div>"}vRightTable+="</div>"}else{if(vDateRowStr=JSGantt.formatDateStr(vTaskStart,vDateDisplayFormat)+" - "+JSGantt.formatDateStr(vTaskEnd,vDateDisplayFormat),"minute"==vFormat)vTaskRight=(Date.parse(vTaskList[i].getEnd())-Date.parse(vTaskList[i].getStart()))/6e4+1/vColUnit,vTaskLeft=Math.ceil((Date.parse(vTaskList[i].getStart())-Date.parse(vMinDate))/6e4);else if("hour"==vFormat)vTaskRight=(Date.parse(vTaskList[i].getEnd())-Date.parse(vTaskList[i].getStart()))/36e5+1/vColUnit,vTaskLeft=(Date.parse(vTaskList[i].getStart())-Date.parse(vMinDate))/36e5;else if(vTaskRight=(Date.parse(vTaskList[i].getEnd())-Date.parse(vTaskList[i].getStart()))/864e5+1/vColUnit,vTaskLeft=Math.ceil((Date.parse(vTaskList[i].getStart())-Date.parse(vMinDate))/864e5),vFormat="day"){var tTime=new Date;tTime.setTime(Date.parse(vTaskList[i].getStart())),tTime.getMinutes()>29&&(vTaskLeft+=.5)}if(vTaskList[i].getGroup()){if(vRightTable+='<DIV><TABLE style="position:relative; top:0px; width: '+vChartWidth+'px;" cellSpacing=0 cellPadding=0 border=0><TR id=childrow_'+vID+' class=yesdisplay style="HEIGHT: 20px" bgColor=#f3f3f3 onMouseover=g.mouseOver(this,'+vID+',"right","group") onMouseout=g.mouseOut(this,'+vID+',"right","group")>'+vItemRowStr+"</TR></TABLE></DIV>",vRightTable+="<div id=bardiv_"+vID+' style="position:absolute; top:5px; left:'+Math.ceil(vTaskLeft*vDayWidth+1)+"px; height: 7px; width:"+Math.ceil(vTaskRight*vDayWidth-1)+'px"><div id=taskbar_'+vID+' title="'+vTaskList[i].getName()+": "+vDateRowStr+'" class=gtask style="background-color:#428bca; border-radius:4px 4px 0 0; height: 10px; width:'+Math.ceil(vTaskRight*vDayWidth-1)+'px;  cursor: pointer;opacity:0.9;"><div style="Z-INDEX: -4; float:left; background-color:#666666; height:3px; overflow: hidden; margin-top:1px; margin-left:1px; margin-right:1px; filter: alpha(opacity=80); opacity:0.8; width:'+vTaskList[i].getCompStr()+"; "+(1==vTaskList[i].getLinkIsAction()?'cursor: pointer;" onclick="'+vTaskList[i].getLink()+';">':'cursor: pointer;" onclick=JSGantt.taskLink("'+vTaskList[i].getLink()+'",300,200);>')+'</div></div><div style="Z-INDEX: -4; float:left; background-color:#428bca; height:4px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#428bca; height:4px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:left; background-color:#428bca; height:3px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#428bca; height:3px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:left; background-color:#428bca; height:2px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#428bca; height:2px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:left; background-color:#428bca; height:1px; overflow: hidden; width:1px;"></div><div style="Z-INDEX: -4; float:right; background-color:#428bca; height:1px; overflow: hidden; width:1px;"></div>',g.getCaptionType()){switch(vCaptionStr="",g.getCaptionType()){case"Caption":vCaptionStr=vTaskList[i].getCaption();break;case"Resource":vCaptionStr=vTaskList[i].getResource();break;case"Duration":vCaptionStr=vTaskList[i].getDuration(vFormat);break;case"Complete":vCaptionStr=vTaskList[i].getCompStr()}vRightTable+='<div style="FONT-SIZE:12px; position:absolute; top:-3px; width:120px; left:'+(Math.ceil(vTaskRight*vDayWidth-1)+6)+'px">'+vCaptionStr+"</div>"}vRightTable+="</div>"}else{if(vDivStr='<DIV><TABLE style="position:relative; top:0px; width: '+vChartWidth+'px;" cellSpacing=0 cellPadding=0 border=0><TR id=childrow_'+vID+' class=yesdisplay style="HEIGHT: 20px" bgColor=#ffffff onMouseover=g.mouseOver(this,'+vID+',"right","row") onMouseout=g.mouseOut(this,'+vID+',"right","row")>'+vItemRowStr+"</TR></TABLE></DIV>",vRightTable+=vDivStr,vRightTable+="<div id=bardiv_"+vID+' style="position:absolute; top:4px; left:'+Math.ceil(vTaskLeft*vDayWidth+1)+"px; height:18px; width:"+Math.ceil(vTaskRight*vDayWidth-1)+'px"><div id=taskbar_'+vID+' title="'+vTaskList[i].getName()+": "+vDateRowStr+'" class=gtask style="background-color:#'+vTaskList[i].getColor()+"; height: 13px; width:"+Math.ceil(vTaskRight*vDayWidth-1)+'px; cursor: pointer;opacity:0.9;" '+(1==vTaskList[i].getLinkIsAction()?'onclick="'+vTaskList[i].getLink()+';" >':'onclick=JSGantt.taskLink("'+vTaskList[i].getLink()+'",300,200); >')+'<div class=gcomplete style="Z-INDEX: -4; float:left; background-color:black; height:5px; overflow: auto; margin-top:4px; filter: alpha(opacity=40); opacity:0.4; width:'+vTaskList[i].getCompStr()+'; overflow:hidden"></div></div>',g.getCaptionType()){switch(vCaptionStr="",g.getCaptionType()){case"Caption":vCaptionStr=vTaskList[i].getCaption();break;case"Resource":vCaptionStr=vTaskList[i].getResource();break;case"Duration":vCaptionStr=vTaskList[i].getDuration(vFormat);break;case"Complete":vCaptionStr=vTaskList[i].getCompStr()}vRightTable+='<div style="FONT-SIZE:12px; position:absolute; top:-3px; width:120px; left:'+(Math.ceil(vTaskRight*vDayWidth-1)+6)+'px">'+vCaptionStr+"</div>"}vRightTable+="</div>"}}vRightTable+="</DIV>"}vMainTable+=vRightTable+"</DIV></TD></TR></TBODY></TABLE></BODY></HTML>",vDiv.innerHTML=vMainTable}},this.mouseOver=function(pObj,pID,pPos,pType){vID="right"==pPos?"child_"+pID:"childrow_"+pID,pObj.bgColor="#ffffaa",vRowObj=JSGantt.findObj(vID),vRowObj&&(vRowObj.bgColor="#ffffaa")},this.mouseOut=function(pObj,pID,pPos,pType){vID="right"==pPos?"child_"+pID:"childrow_"+pID,pObj.bgColor="#ffffff",vRowObj=JSGantt.findObj(vID),vRowObj&&("group"==pType?(pObj.bgColor="#f3f3f3",vRowObj.bgColor="#f3f3f3"):(pObj.bgColor="#ffffff",vRowObj.bgColor="#ffffff"))}},JSGantt.processRows=function(pList,pID,pRow,pLevel,pOpen){var vMinDate=new Date,vMaxDate=new Date,vMinSet=0,vMaxSet=0,vList=pList,vLevel=pLevel,i=0,vNumKid=0,vCompSum=0,vVisible=pOpen;for(i=0;i<pList.length;i++)pList[i].getParent()==pID&&(vVisible=pOpen,pList[i].setVisible(vVisible),1==vVisible&&0==pList[i].getOpen()&&(vVisible=0),pList[i].setLevel(vLevel),vNumKid++,1==pList[i].getGroup()&&JSGantt.processRows(vList,pList[i].getID(),i,vLevel+1,vVisible),(0==vMinSet||pList[i].getStart()<vMinDate)&&(vMinDate=pList[i].getStart(),vMinSet=1),(0==vMaxSet||pList[i].getEnd()>vMaxDate)&&(vMaxDate=pList[i].getEnd(),vMaxSet=1),vCompSum+=pList[i].getCompVal());pRow>=0&&(pList[pRow].setStart(vMinDate),pList[pRow].setEnd(vMaxDate),pList[pRow].setNumKid(vNumKid),pList[pRow].setCompVal(Math.ceil(vCompSum/vNumKid)))},JSGantt.getMinDate=function getMinDate(pList,pFormat){var vDate=new Date;for(vDate.setFullYear(pList[0].getStart().getFullYear(),pList[0].getStart().getMonth(),pList[0].getStart().getDate()),i=0;i<pList.length;i++)Date.parse(pList[i].getStart())<Date.parse(vDate)&&vDate.setFullYear(pList[i].getStart().getFullYear(),pList[i].getStart().getMonth(),pList[i].getStart().getDate());if("minute"==pFormat)vDate.setHours(0),vDate.setMinutes(0);else if("hour"==pFormat)vDate.setHours(0),vDate.setMinutes(0);else if("day"==pFormat)for(vDate.setDate(vDate.getDate()-1);vDate.getDay()%7>0;)vDate.setDate(vDate.getDate()-1);else if("week"==pFormat)for(vDate.setDate(vDate.getDate()-7);vDate.getDay()%7>0;)vDate.setDate(vDate.getDate()-1);else if("month"==pFormat)for(;vDate.getDate()>1;)vDate.setDate(vDate.getDate()-1);else"quarter"==pFormat&&(0==vDate.getMonth()||1==vDate.getMonth()||2==vDate.getMonth()?vDate.setFullYear(vDate.getFullYear(),0,1):3==vDate.getMonth()||4==vDate.getMonth()||5==vDate.getMonth()?vDate.setFullYear(vDate.getFullYear(),3,1):6==vDate.getMonth()||7==vDate.getMonth()||8==vDate.getMonth()?vDate.setFullYear(vDate.getFullYear(),6,1):9!=vDate.getMonth()&&10!=vDate.getMonth()&&11!=vDate.getMonth()||vDate.setFullYear(vDate.getFullYear(),9,1));return vDate},JSGantt.getMaxDate=function(pList,pFormat){var vDate=new Date;for(vDate.setFullYear(pList[0].getEnd().getFullYear(),pList[0].getEnd().getMonth(),pList[0].getEnd().getDate()),i=0;i<pList.length;i++)Date.parse(pList[i].getEnd())>Date.parse(vDate)&&vDate.setTime(Date.parse(pList[i].getEnd()));if("minute"==pFormat&&(vDate.setHours(vDate.getHours()+1),vDate.setMinutes(59)),"hour"==pFormat&&vDate.setHours(vDate.getHours()+2),"day"==pFormat)for(vDate.setDate(vDate.getDate()+1);vDate.getDay()%6>0;)vDate.setDate(vDate.getDate()+1);if("week"==pFormat)for(vDate.setDate(vDate.getDate()+11);vDate.getDay()%6>0;)vDate.setDate(vDate.getDate()+1);if("month"==pFormat){for(;vDate.getDay()>1;)vDate.setDate(vDate.getDate()+1);vDate.setDate(vDate.getDate()-1)}return"quarter"==pFormat&&(0==vDate.getMonth()||1==vDate.getMonth()||2==vDate.getMonth()?vDate.setFullYear(vDate.getFullYear(),2,31):3==vDate.getMonth()||4==vDate.getMonth()||5==vDate.getMonth()?vDate.setFullYear(vDate.getFullYear(),5,30):6==vDate.getMonth()||7==vDate.getMonth()||8==vDate.getMonth()?vDate.setFullYear(vDate.getFullYear(),8,30):9!=vDate.getMonth()&&10!=vDate.getMonth()&&11!=vDate.getMonth()||vDate.setFullYear(vDate.getFullYear(),11,31)),vDate},JSGantt.findObj=function(theObj,theDoc){var p,i,foundObj;for(theDoc||(theDoc=document),(p=theObj.indexOf("?"))>0&&parent.frames.length&&(theDoc=parent.frames[theObj.substring(p+1)].document,theObj=theObj.substring(0,p)),!(foundObj=theDoc[theObj])&&theDoc.all&&(foundObj=theDoc.all[theObj]),i=0;!foundObj&&i<theDoc.forms.length;i++)foundObj=theDoc.forms[i][theObj];for(i=0;!foundObj&&theDoc.layers&&i<theDoc.layers.length;i++)foundObj=JSGantt.findObj(theObj,theDoc.layers[i].document);return!foundObj&&document.getElementById&&(foundObj=document.getElementById(theObj)),foundObj},JSGantt.changeFormat=function(pFormat,ganttObj){ganttObj?(ganttObj.setFormat(pFormat),ganttObj.DrawDependencies()):alert("Chart undefined")},JSGantt.folder=function(pID,ganttObj){var vList=ganttObj.getList();for(i=0;i<vList.length;i++)vList[i].getID()==pID&&(1==vList[i].getOpen()?(vList[i].setOpen(0),JSGantt.hide(pID,ganttObj),JSGantt.isIE()?JSGantt.findObj("group_"+pID).innerText="+":JSGantt.findObj("group_"+pID).textContent="+"):(vList[i].setOpen(1),JSGantt.show(pID,1,ganttObj),JSGantt.isIE()?JSGantt.findObj("group_"+pID).innerText="�":JSGantt.findObj("group_"+pID).textContent="�"))},JSGantt.hide=function(pID,ganttObj){for(var vList=ganttObj.getList(),vID=0,i=0;i<vList.length;i++)vList[i].getParent()==pID&&(vID=vList[i].getID(),JSGantt.findObj("child_"+vID).style.display="none",JSGantt.findObj("childgrid_"+vID).style.display="none",vList[i].setVisible(0),1==vList[i].getGroup()&&JSGantt.hide(vID,ganttObj))},JSGantt.show=function(pID,pTop,ganttObj){for(var vList=ganttObj.getList(),vID=0,i=0;i<vList.length;i++)vList[i].getParent()==pID&&(vID=vList[i].getID(),1==pTop?JSGantt.isIE()?"+"==JSGantt.findObj("group_"+pID).innerText&&(JSGantt.findObj("child_"+vID).style.display="",JSGantt.findObj("childgrid_"+vID).style.display="",vList[i].setVisible(1)):"+"==JSGantt.findObj("group_"+pID).textContent&&(JSGantt.findObj("child_"+vID).style.display="",JSGantt.findObj("childgrid_"+vID).style.display="",vList[i].setVisible(1)):JSGantt.isIE()?"�"==JSGantt.findObj("group_"+pID).innerText&&(JSGantt.findObj("child_"+vID).style.display="",JSGantt.findObj("childgrid_"+vID).style.display="",vList[i].setVisible(1)):"�"==JSGantt.findObj("group_"+pID).textContent&&(JSGantt.findObj("child_"+vID).style.display="",JSGantt.findObj("childgrid_"+vID).style.display="",vList[i].setVisible(1)),1==vList[i].getGroup()&&JSGantt.show(vID,0,ganttObj))},JSGantt.taskLink=function(pRef,pWidth,pHeight){vWidth=pWidth||400,vHeight=pHeight||400;var OpenWindow=window.open(pRef,"newwin","height="+vHeight+",width="+vWidth)},JSGantt.parseDateStr=function(pDateStr,pFormatStr){var vDate=new Date;switch(vDate.setTime(Date.parse(pDateStr)),pFormatStr){case"mm/dd/yyyy":var vDateParts=pDateStr.split("/");vDate.setFullYear(parseInt(vDateParts[2],10),parseInt(vDateParts[0],10)-1,parseInt(vDateParts[1],10));break;case"dd/mm/yyyy":var vDateParts=pDateStr.split("/");vDate.setFullYear(parseInt(vDateParts[2],10),parseInt(vDateParts[1],10)-1,parseInt(vDateParts[0],10));break;case"yyyy-mm-dd":var vDateParts=pDateStr.split("-");vDate.setFullYear(parseInt(vDateParts[0],10),parseInt(vDateParts[1],10)-1,parseInt(vDateParts[1],10))}return vDate},JSGantt.formatDateStr=function(pDate,pFormatStr){vYear4Str=pDate.getFullYear()+"",vYear2Str=vYear4Str.substring(2,4),vMonthStr=pDate.getMonth()+1+"",vDayStr=pDate.getDate()+"";var vDateStr="";switch(pFormatStr){case"mm/dd/yyyy":return vMonthStr+"/"+vDayStr+"/"+vYear4Str;case"dd/mm/yyyy":return vDayStr+"/"+vMonthStr+"/"+vYear4Str;case"yyyy-mm-dd":return vYear4Str+"-"+vMonthStr+"-"+vDayStr;case"mm/dd/yy":return vMonthStr+"/"+vDayStr+"/"+vYear2Str;case"dd/mm/yy":return vDayStr+"/"+vMonthStr+"/"+vYear2Str;case"yy-mm-dd":return vYear2Str+"-"+vMonthStr+"-"+vDayStr;case"mm/dd":return vMonthStr+"/"+vDayStr;case"dd/mm":return vDayStr+"/"+vMonthStr}},JSGantt.parseXML=function(ThisFile,pGanttVar){var is_chrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;try{xmlDoc=new ActiveXObject("Microsoft.XMLDOM")}catch(e){try{0==is_chrome&&(xmlDoc=document.implementation.createDocument("","",null))}catch(e){return void alert(e.message)}}0==is_chrome?(xmlDoc.async=!1,xmlDoc.load(ThisFile),JSGantt.AddXMLTask(pGanttVar),xmlDoc=null,Task=null):(JSGantt.ChromeLoadXML(ThisFile,pGanttVar),ta=null)},JSGantt.AddXMLTask=function(pGanttVar){Task=xmlDoc.getElementsByTagName("task");for(var n=xmlDoc.documentElement.childNodes.length,i=0;i<n;i++){try{pID=Task[i].getElementsByTagName("pID")[0].childNodes[0].nodeValue}catch(error){pID=0}if(pID*=1,0!=pID){try{pName=Task[i].getElementsByTagName("pName")[0].childNodes[0].nodeValue}catch(error){pName="No Task Name"}try{pColor=Task[i].getElementsByTagName("pColor")[0].childNodes[0].nodeValue}catch(error){pColor="0000ff"}try{pParent=Task[i].getElementsByTagName("pParent")[0].childNodes[0].nodeValue}catch(error){pParent=0}pParent*=1;try{pStart=Task[i].getElementsByTagName("pStart")[0].childNodes[0].nodeValue}catch(error){pStart=""}try{pEnd=Task[i].getElementsByTagName("pEnd")[0].childNodes[0].nodeValue}catch(error){pEnd=""}try{pLink=Task[i].getElementsByTagName("pLink")[0].childNodes[0].nodeValue}catch(error){pLink=""}try{pMile=Task[i].getElementsByTagName("pMile")[0].childNodes[0].nodeValue}catch(error){pMile=0}pMile*=1;try{pRes=Task[i].getElementsByTagName("pRes")[0].childNodes[0].nodeValue}catch(error){pRes=""}try{pComp=Task[i].getElementsByTagName("pComp")[0].childNodes[0].nodeValue}catch(error){pComp=0}pComp*=1;try{pGroup=Task[i].getElementsByTagName("pGroup")[0].childNodes[0].nodeValue}catch(error){pGroup=0}pGroup*=1;try{pOpen=Task[i].getElementsByTagName("pOpen")[0].childNodes[0].nodeValue}catch(error){pOpen=1}pOpen*=1;try{pDepend=Task[i].getElementsByTagName("pDepend")[0].childNodes[0].nodeValue}catch(error){pDepend=0}0==pDepend.length&&(pDepend="");try{pCaption=Task[i].getElementsByTagName("pCaption")[0].childNodes[0].nodeValue}catch(error){pCaption=""}try{pActionLink=Task[i].getElementsByTagName("pActionLink")[0].childNodes[0].nodeValue}catch(error){pActionLink=0}pActionLink*=1,pGanttVar.AddTaskItem(new JSGantt.TaskItem(pID,pName,pStart,pEnd,pColor,pLink,pMile,pRes,pComp,pGroup,pParent,pOpen,pDepend,pCaption,pActionLink))}}},JSGantt.ChromeLoadXML=function(ThisFile,pGanttVar){XMLLoader=new XMLHttpRequest,XMLLoader.onreadystatechange=function(){JSGantt.ChromeXMLParse(pGanttVar)},XMLLoader.open("GET",ThisFile,!1),XMLLoader.send(null)},JSGantt.parseJSON=function(json,pGanttVar){for(var n=json.tasks.length,i=0;i<n;i++){var task=json.tasks[i];if(task.pID&&""!=task.pID)var pID=task.pID;else var pID=0;if(pID*=1,task.pName&&""!=task.pName)var pName=task.pName;else var pName="No Task Name";if(task.pStart&&""!=task.pStart)var pStart=task.pStart;else var pStart="";if(task.pEnd&&""!=task.pEnd)var pEnd=task.pEnd;else var pEnd="";if(task.pColor&&""!=task.pColor)var pColor=task.pColor;else var pColor="0000ff";if(task.pLink&&""!=task.pLink)var pLink=task.pLink;else var pLink="";if(task.pMile&&""!=task.pMile)var pMile=task.pMile;else var pMile=0;if(pMile*=1,task.pRes&&""!=task.pRes)var pRes=task.pRes;else var pRes="";if(task.pComp&&""!=task.pComp)var pComp=task.pComp;else var pComp=0;if(pComp*=1,task.pGroup&&""!=task.pGroup)var pGroup=task.pGroup;else var pGroup=0;if(pGroup*=1,task.pParent&&""!=task.pParent)var pParent=task.pParent;else var pParent=0;if(pParent*=1,task.pOpen&&""!=task.pOpen)var pOpen=task.pOpen;else var pOpen=1;if(pOpen*=1,task.pDepend&&""!=task.pDepend)var pDepend=task.pDepend;else var pDepend="";if(0==pDepend.length&&(pDepend=""),task.pCaption&&""!=task.pCaption)var pCaption=task.pCaption;else var pCaption="";if(task.pActionLink&&""!=task.pActionLink)var pActionLink=task.pActionLink;else var pActionLink=0;pGanttVar.AddTaskItem(new JSGantt.TaskItem(pID,pName,pStart,pEnd,pColor,pLink,pMile,pRes,pComp,pGroup,pParent,pOpen,pDepend,pCaption,pActionLink))}},JSGantt.ChromeXMLParse=function(pGanttVar){if(4==XMLLoader.readyState)for(var ta=XMLLoader.responseText.split(/<task>/gi),n=ta.length,i=1;i<n;i++){var te,te,te,te,te,te,te,te,te,te,te,te,te,te,te;if(Task=ta[i].replace(/<[\/]p/g,"<p"),(te=Task.split(/<pid>/i)).length>2)var pID=te[1];else var pID=0;if(pID*=1,(te=Task.split(/<pName>/i)).length>2)var pName=te[1];else var pName="No Task Name";if((te=Task.split(/<pstart>/i)).length>2)var pStart=te[1];else var pStart="";if((te=Task.split(/<pEnd>/i)).length>2)var pEnd=te[1];else var pEnd="";if((te=Task.split(/<pColor>/i)).length>2)var pColor=te[1];else var pColor="0000ff";if((te=Task.split(/<pLink>/i)).length>2)var pLink=te[1];else var pLink="";if((te=Task.split(/<pMile>/i)).length>2)var pMile=te[1];else var pMile=0;if(pMile*=1,(te=Task.split(/<pRes>/i)).length>2)var pRes=te[1];else var pRes="";if((te=Task.split(/<pComp>/i)).length>2)var pComp=te[1];else var pComp=0;if(pComp*=1,(te=Task.split(/<pGroup>/i)).length>2)var pGroup=te[1];else var pGroup=0;if(pGroup*=1,(te=Task.split(/<pParent>/i)).length>2)var pParent=te[1];else var pParent=0;if(pParent*=1,(te=Task.split(/<pOpen>/i)).length>2)var pOpen=te[1];else var pOpen=1;if(pOpen*=1,(te=Task.split(/<pDepend>/i)).length>2)var pDepend=te[1];else var pDepend="";if(0==pDepend.length&&(pDepend=""),(te=Task.split(/<pCaption>/i)).length>2)var pCaption=te[1];else var pCaption="";if((te=Task.split(/<pActionLink>/i)).length>2)var pActionLink=te[1];else var pActionLink=0;pActionLink*=1,pGanttVar.AddTaskItem(new JSGantt.TaskItem(pID,pName,pStart,pEnd,pColor,pLink,pMile,pRes,pComp,pGroup,pParent,pOpen,pDepend,pCaption,pActionLink))}},JSGantt.benchMark=function(pItem){var vEndTime=(new Date).getTime();alert(pItem+": Elapsed time: "+(vEndTime-vBenchTime)/1e3+" seconds."),vBenchTime=(new Date).getTime()};